<!doctype html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="description" content="Scopri come ottenere fino al 65% di detrazione fiscale acquistando un bene reale legato al mondo Bitcoin. OroDigitale: il portale italiano sul mining reale e sui vantaggi fiscali del futuro." />
    <title>OroDigitale ‚Äì Dal Mining al Risparmio Fiscale</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
      :root{--bg: linear-gradient(180deg,#05060a 0%, #0a0f1a 100%);--card: rgba(255,255,255,0.04);--muted:#9aa4b2;--accent:#f59e0b;--accent-2:#fbbf24;--text:#e6eef6}
      *{box-sizing:border-box}
      html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased}
      a{color:inherit}
      .container{max-width:1100px;margin:0 auto;padding:0 20px}
      header{position:relative;padding:64px 0 48px}
      .hero{display:grid;grid-template-columns:1fr 420px;gap:32px;align-items:center}
      .hero-left h1{font-size:clamp(2rem,5vw,3.6rem);margin:0 0 18px;line-height:1.02}
      .subtitle{color:var(--muted);font-size:1.05rem;margin:0 0 22px}
      .cta{display:inline-block;background:var(--accent);color:#081021;padding:12px 18px;border-radius:10px;font-weight:700;text-decoration:none}
      .features{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-top:28px}
      .card{background:var(--card);padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.04)}
      .hero-right{background:linear-gradient(180deg,rgba(255,255,255,0.03),transparent);padding:20px;border-radius:12px;border:1px solid rgba(255,255,255,0.04)}
      .price{font-size:1.25rem;font-weight:700;color:var(--accent-2)}
      main{padding:36px 0}
      .section{margin:28px 0}
      .lead-cta{display:flex;gap:12px;align-items:center}
      footer{padding:28px 0;border-top:1px solid rgba(255,255,255,0.02);color:var(--muted);font-size:0.95rem}
      /* Chat widget */
      .chat-button{position:fixed;right:20px;bottom:20px;background:linear-gradient(180deg,var(--accent),var(--accent-2));color:#081021;border-radius:999px;padding:14px 18px;font-weight:700;border:none;cursor:pointer;box-shadow:0 6px 18px rgba(11,19,34,0.6)}
      .chat-modal{position:fixed;right:20px;bottom:80px;width:360px;max-width:calc(100% - 40px);background:#071029;border-radius:12px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 10px 30px rgba(2,6,23,0.7);overflow:hidden;display:flex;flex-direction:column}
      .chat-header{padding:12px 14px;background:linear-gradient(90deg,rgba(0,0,0,0.2),rgba(255,255,255,0.02));display:flex;align-items:center;gap:10px}
      .chat-messages{padding:12px;flex:1;overflow:auto;min-height:140px}
      .msg{margin:8px 0;padding:10px 12px;border-radius:10px;max-width:84%}
      .msg.user{background:#0b283f;color:#dff3ff;margin-left:auto}
      .msg.bot{background:rgba(255,255,255,0.03);color:var(--text)}
      .chat-input{display:flex;padding:10px;background:#041228;border-top:1px solid rgba(255,255,255,0.02)}
      .chat-input input{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--text)}
      .chat-input button{margin-left:8px;padding:10px 12px;border-radius:8px;background:var(--accent);border:none;color:#081021;font-weight:700}
      @media (max-width:900px){.hero{grid-template-columns:1fr}.features{grid-template-columns:1fr}}
    </style>
  </head>
  <body>
    <header>
      <div class="container">
        <div class="hero">
          <div class="hero-left">
            <h1>Dal Mining al Risparmio Fiscale</h1>
            <p class="subtitle">Trasforma il digitale in un acquisto reale con potenziali detrazioni fino al <strong>65%</strong>. Acquista macchine ASIC, diventa proprietario e sfrutta le opportunit√† fiscali in modo chiaro e legale.</p>
            <div class="lead-cta">
              <a class="cta" href="#lead">Richiedi info</a>
              <a class="cta" href="#" style="background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--text);font-weight:600">Scarica guida</a>
            </div>
            <div class="features" aria-hidden>
              <div class="card"><strong>‚úÖ Propriet√† reale</strong><div style="color:var(--muted);margin-top:8px">Acquisti e sei proprietario al 100%.</div></div>
              <div class="card"><strong>‚öñÔ∏è Vantaggi fiscali</strong><div style="color:var(--muted);margin-top:8px">Detrazioni e regime agevolato per startup.</div></div>
              <div class="card"><strong>üîí Assistenza e Garanzia</strong><div style="color:var(--muted);margin-top:8px">Contratto italiano e certificazioni.</div></div>
            </div>
          </div>

          <aside class="hero-right" aria-label="preview">
            <div style="display:flex;align-items:center;justify-content:space-between">
              <div>
                <div style="font-size:.9rem;color:var(--muted)">Prodotto suggerito</div>
                <div class="price">ASIC intero ‚Äî ‚Ç¨7.450</div>
              </div>
              <div style="text-align:right;color:var(--muted)">245 TH/s</div>
            </div>
            <div style="margin-top:14px;color:var(--muted);font-size:.95rem">Monitoraggio 24/7 ‚Äî Hosting in data center certificati ‚Äî Assistenza dedicata</div>
          </aside>
        </div>
      </div>
    </header>

    <main>
      <div class="container">
        <section class="section">
          <h2 style="margin:0 0 10px">Perch√© OroDigitale</h2>
          <p style="color:var(--muted);max-width:900px">Scegliamo partner affidabili e offriamo ai clienti la possibilit√† di acquistare hardware fisico con tutte le garanzie contrattuali. Il nostro approccio unisce trasparenza fiscale, supporto legale e tecnologie di mining efficienti.</p>
        </section>

        <section class="section">
          <h3>Come funziona</h3>
          <ol style="color:var(--muted)">
            <li>Selezioni il prodotto e firmi il contratto di vendita.</li>
            <li>Il dispositivo viene installato e ospitato nel nostro data center.</li>
            <li>Ricevi report mensili e puoi rivendicare le detrazioni secondo normativa.</li>
          </ol>
        </section>

        <section id="lead" class="section lead">
          <h3>Vuoi maggiori informazioni?</h3>
          <p style="color:var(--muted);margin-bottom:12px">Lascia i tuoi contatti e ti ricontatteremo con una proposta personalizzata.</p>
          <form style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
            <input placeholder="Nome" style="padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text)" />
            <input placeholder="Email" style="padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text)" />
            <button class="cta">Invia richiesta</button>
          </form>
        </section>
      </div>
    </main>

    <footer>
      <div class="container">
        <p>¬© 2025 OroDigitale.eu ‚Äì Portale indipendente di informazione sul mining reale e vantaggi fiscali in Italia.</p>
      </div>
    </footer>

    <!-- Chat widget -->
    <button id="chatToggle" class="chat-button" aria-label="Apri chat">Chat con Flexi</button>
    <div id="chatModal" class="chat-modal" style="display:none" role="dialog" aria-label="Chatbot">
      <div class="chat-header"><strong>Flexi ‚Äî Assistente OroDigitale</strong><button id="chatClose" style="margin-left:auto;background:transparent;border:none;color:var(--muted);cursor:pointer">‚úï</button></div>
      <div id="chatMessages" class="chat-messages" aria-live="polite"></div>
      <div class="chat-input">
        <input id="chatInput" placeholder="Scrivi la tua domanda..." aria-label="Messaggio" />
                <button id="chatSend">Invia</button>
                <button id="chatDebug" title="Debug headers" style="margin-left:8px;background:#222;color:#fff;border-radius:8px;padding:8px 10px;border:none;cursor:pointer">Dbg</button>
      </div>
    </div>

    <script>
      // Minimal chat widget that posts to /api/chat
      const chatToggle = document.getElementById('chatToggle');
      const chatModal = document.getElementById('chatModal');
      const chatClose = document.getElementById('chatClose');
      const chatMessages = document.getElementById('chatMessages');
      const chatInput = document.getElementById('chatInput');
      const chatSend = document.getElementById('chatSend');

      function appendMsg(text, who='bot'){
        const d = document.createElement('div');
        d.className = 'msg ' + (who==='user' ? 'user' : 'bot');
        d.textContent = text;
        chatMessages.appendChild(d);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      chatToggle.addEventListener('click', ()=>{ chatModal.style.display='flex'; chatToggle.style.display='none'; appendMsg('Ciao! Sono Flexi, come posso aiutarti oggi?'); });
      chatClose.addEventListener('click', ()=>{ chatModal.style.display='none'; chatToggle.style.display='block'; });

      async function sendQuestion(){
        const q = (chatInput.value || '').trim();
        if(!q) return;
        appendMsg(q,'user');
        chatInput.value='';
                appendMsg('Sto pensando...','bot');
                try{
                  const res = await fetch('/api/chat', {method:'POST',credentials: 'include',headers:{'Content-Type':'application/json'},body: JSON.stringify({ question: q })});
                  console.log('Fetch /api/chat status:', res.status, res.statusText);
                  if(!res.ok){
                    // try to read response body for more info
                    let text = '';
                    try{ text = await res.text(); }catch(e){ text = '<no body>'; }
                    const errMsg = `Errore server: ${res.status} ${res.statusText} ‚Äî ${text}`;
                    console.error(errMsg);
                    // remove helper if present
                    const helpers = chatMessages.querySelectorAll('.msg');
                    const last = helpers[helpers.length-1];
                    if(last && last.textContent === 'Sto pensando...') last.remove();
                    appendMsg(errMsg);
                    return;
                  }
                  const data = await res.json();
                  // remove the 'Sto pensando...' helper
                  const helpers = chatMessages.querySelectorAll('.msg');
                  const last = helpers[helpers.length-1];
                  if(last && last.textContent === 'Sto pensando...') last.remove();
                  console.log('AI response:', data);
                  appendMsg(data?.text || 'Nessuna risposta');
                }catch(e){
                  console.error('Network error calling /api/chat', e);
                  const helpers = chatMessages.querySelectorAll('.msg');
                  const last = helpers[helpers.length-1];
                  if(last && last.textContent === 'Sto pensando...') last.remove();
                  appendMsg('Errore di rete, riprova ‚Äî ' + (e?.message || e));
                }
      }

      chatSend.addEventListener('click', sendQuestion);
      chatInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); sendQuestion(); }});

      // Debug: call /api/debug and show result
      const chatDebug = document.getElementById('chatDebug');
      chatDebug.addEventListener('click', async ()=>{
        appendMsg('Eseguo debug con header...','bot');
        try{
          const r = await fetch('/api/debug', { method: 'GET', headers: { 'Content-Type': 'application/json', 'X-TEST-TOKEN': 'aaa4c06a227b47b3a5b1eb7202efa296d3a3368aba27441d87705a4d387dfb5f' } });
          const j = await r.json();
          appendMsg('Debug result: ' + JSON.stringify(j));
        }catch(e){
          appendMsg('Debug failed: ' + (e?.message || e));
        }
      });
    </script>
  </body>
</html>